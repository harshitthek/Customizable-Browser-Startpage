<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- SECURITY: Content Security Policy to prevent XSS attacks -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; 
                   script-src 'self'; 
                   style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; 
                   img-src 'self' https: data:; 
                   connect-src 'self' https://api.github.com https://api.quotable.io https://www.google.com; 
                   font-src 'self' https://fonts.gstatic.com; 
                   frame-src 'none'; 
                   object-src 'none'; 
                   base-uri 'self';">
    <title>DailyCosmos</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <script src="js/main.js" defer></script>
</head>

<body data-theme="slate">

    <!-- Top Right UI Controls -->
    <div class="top-right-controls">
        <button id="add-link-btn" title="Add New Link">â•</button>
        <button id="bg-settings-btn" title="Background Settings">ğŸ–¼ï¸</button>
        <button id="theme-btn" title="Change theme">ğŸŒˆ</button>
    </div>

    <!-- Particle Background -->
    <canvas id="particle-canvas"></canvas>

    <!-- Widget Panel -->
    <div id="widget-panel">
        <div id="search-widget" class="widget">
            <input type="text" id="search-input" placeholder="ğŸ” Search bookmarks..." />
        </div>
        <div id="quote-widget" class="widget">
            <p id="quote-text">"Loading..."</p>
            <span id="quote-author">- Author</span>
        </div>
    </div>

    <!-- GitHub Panel (Right Side) -->
    <div id="github-panel">
        <div id="github-widget" class="widget">
            <h3 class="widget-title">ğŸ’» GitHub</h3>
            <div id="github-profile">
                <div class="gh-profile-loading">Loading...</div>
            </div>
            <div id="github-repos"></div>
            <input type="text" id="gh-username-input" placeholder="GitHub username">
            <button id="gh-update-btn" class="btn-primary">Update</button>
        </div>
    </div>

    <main>
        <!-- Main Search Bar (Top Position) -->
        <div id="main-search-container">
            <div id="search-engine-icon" title="Click to switch">
                <img src="https://www.google.com/favicon.ico" alt="Search" id="engine-icon">
            </div>
            <input type="text" id="main-search-input" placeholder="Search the web...">
            <button id="search-btn" title="Search">ğŸ”</button>
        </div>

        <div class="container">
            <h1 id="greeting">Good day, <span id="name">Guest</span></h1>
            <div id="clock">--:--:--</div>
            <button id="clock-settings-btn" class="clock-settings-icon" title="Clock Settings">âš™ï¸</button>
            <div id="date"></div>
        </div>
        <section id="links-container"></section>
    </main>

    <!-- Panels, Modals, and Audio -->
    <div id="toast-container"></div>
    <div id="context-menu" class="panel hidden">
        <button id="context-edit-btn">âœï¸ Edit</button>
        <button id="context-delete-btn">âŒ Delete</button>
    </div>

    <div id="theme-panel" class="panel hidden">
        <h3>Themes</h3>
        <button class="theme-option" data-theme="slate">Dark Slate</button>
        <button class="theme-option" data-theme="light">Light</button>
        <button class="theme-option" data-theme="ocean">Ocean</button>
        <button class="theme-option" data-theme="cyberpunk">ğŸŒƒ Cyberpunk</button>
        <button class="theme-option" data-theme="sunset">ğŸŒ… Sunset</button>
        <button class="theme-option" data-theme="forest">ğŸŒ² Forest</button>
        <button class="theme-option" data-theme="aurora">âœ¨ Aurora Wave</button>
        <button class="theme-option" data-theme="northern">ğŸŒŒ Northern Lights</button>
        <button class="theme-option" data-theme="midnight">ğŸŒ™ Midnight</button>
        <button class="theme-option" data-theme="rosegold">ğŸŒ¹ Rose Gold</button>
        <button class="theme-option" id="custom-theme-btn">Custom</button>

        <!-- THIS WAS MISSING - ADDED BACK -->
        <div id="custom-theme-panel" class="hidden">
            <div class="color-picker-group">
                <label for="accent-color-input">Accent Color</label>
                <input type="color" id="accent-color-input" value="#3b82f6">
            </div>
            <div class="form-buttons">
                <button type="button" class="btn-primary" id="save-custom-theme-btn">Save</button>
                <button type="button" class="btn-secondary" id="back-to-themes-btn">Back</button>
            </div>
        </div>
    </div>

    <div id="bg-settings-panel" class="panel hidden">
        <h3>Background Settings</h3>
        <div class="form-group">
            <label>Upload Image</label>
            <input type="file" id="bg-image-upload" accept="image/*">
        </div>
        <div class="form-group">
            <label>Or Image URL</label>
            <input type="text" id="bg-image-url" placeholder="https://example.com/image.jpg">
            <button type="button" class="btn-primary" id="apply-bg-url">Apply</button>
        </div>
        <div class="form-group">
            <label>Blur: <span id="blur-value">5</span>px</label>
            <input type="range" id="bg-blur" min="0" max="20" value="5">
        </div>
        <div class="form-group">
            <label>Brightness: <span id="brightness-value">100</span>%</label>
            <input type="range" id="bg-brightness" min="50" max="150" value="100">
        </div>
        <button type="button" class="btn-secondary" id="reset-bg-btn">Reset to Gradient</button>
        <hr style="margin: 20px 0; border: 1px solid rgba(255,255,255,0.1);">
        <h4 style="font-size: 14px; margin-bottom: 10px;">Backup & Restore</h4>
        <button type="button" class="btn-primary" id="export-settings-btn" style="width: 100%; margin-bottom: 8px;">â¬‡ï¸
            Export All Settings</button>
        <input type="file" id="import-settings-input" accept=".json" style="display: none;">
        <button type="button" class="btn-secondary" id="import-settings-btn" style="width: 100%;">â¬†ï¸ Import
            Settings</button>
    </div>

    <div id="clock-settings-panel" class="panel hidden">
        <button class="close-btn">&times;</button>
        <h3>Clock Settings</h3>
        <div class="form-group">
            <label>
                <input type="checkbox" id="clock-24hr"> 24-hour format
            </label>
        </div>
        <div class="form-group">
            <label>
                <input type="checkbox" id="clock-seconds" checked> Show seconds
            </label>
        </div>
    </div>

    <div id="add-link-modal" class="modal-overlay hidden">
        <div class="modal-content panel">
            <button class="close-btn">&times;</button>
            <h2 id="modal-title">Add New Link</h2>
            <form id="add-link-form" novalidate>
                <div class="form-group">
                    <label for="link-name">Name</label>
                    <input type="text" id="link-name-input" required autocomplete="off">
                </div>
                <div class="form-group">
                    <label for="link-url">URL</label>
                    <input type="url" id="link-url-input" placeholder="https://example.com" required autocomplete="off">
                </div>
                <div class="form-buttons">
                    <button type="submit" class="btn-primary" id="modal-submit-btn">Add Link</button>
                    <button type="button" class="btn-secondary" id="cancel-btn">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <div id="add-link-modal" class="modal-overlay hidden">
        <div class="modal-content panel">
            <button class="close-btn">&times;</button>
            <h3 id="modal-title">Add New Link</h3>
            <form id="add-link-form">
                <div class="form-group">
                    <label for="link-name-input">Name</label>
                    <input type="text" id="link-name-input" required>
                </div>
                <div class="form-group">
                    <label for="link-url-input">URL</label>
                    <input type="url" id="link-url-input" required>
                </div>
                <div class="form-buttons">
                    <button type="submit" id="modal-submit-btn" class="btn-primary">Add Link</button>
                    <button type="button" id="cancel-btn" class="btn-secondary">Cancel</button>
                </div>
            </form>
        </div>
    </div>
</body>

</html>